{"version":3,"file":"index.0d8feba6.js","sources":["../../vite/modulepreload-polyfill","../../vite/preload-helper","../../main.ts"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","const scriptRel = 'modulepreload';const seen = {};const base = '';export const __vitePreload = function preload(baseModule, deps) {\n    // @ts-ignore\n    if (!__VITE_IS_MODERN__ || !deps || deps.length === 0) {\n        return baseModule();\n    }\n    return Promise.all(deps.map((dep) => {\n        // @ts-ignore\n        dep = `${base}${dep}`;\n        // @ts-ignore\n        if (dep in seen)\n            return;\n        // @ts-ignore\n        seen[dep] = true;\n        const isCss = dep.endsWith('.css');\n        const cssSelector = isCss ? '[rel=\"stylesheet\"]' : '';\n        // @ts-ignore check if the file is already preloaded by SSR markup\n        if (document.querySelector(`link[href=\"${dep}\"]${cssSelector}`)) {\n            return;\n        }\n        // @ts-ignore\n        const link = document.createElement('link');\n        // @ts-ignore\n        link.rel = isCss ? 'stylesheet' : scriptRel;\n        if (!isCss) {\n            link.as = 'script';\n            link.crossOrigin = '';\n        }\n        link.href = dep;\n        // @ts-ignore\n        document.head.appendChild(link);\n        if (isCss) {\n            return new Promise((res, rej) => {\n                link.addEventListener('load', res);\n                link.addEventListener('error', rej);\n            });\n        }\n    })).then(() => baseModule());\n}","import type { TransformOptions } from \"esbuild\";\n\ntype esbuild_t = typeof import(\"esbuild\");\n\nconst $ = (sel: string) => document.querySelector(sel)!;\n\nfunction leave(el: Element, ms = 200) {\n    el.classList.add(\"leave\", \"leave-active\");\n    requestAnimationFrame(() => {\n        el.classList.remove(\"leave\");\n        el.classList.add(\"leave-to\");\n    });\n    setTimeout(() => el.remove(), ms);\n}\n\nconst JsDelivrAPI = \"https://data.jsdelivr.com/v1/package/npm/esbuild-wasm\";\nconst urlPrefix = \"https://cdn.jsdelivr.net/npm/esbuild-wasm\";\nconst urls = {\n    browser: (version: string) => `${urlPrefix}@${version}/esm/browser.js`,\n    wasm: (version: string) => `${urlPrefix}@${version}/esbuild.wasm`,\n};\n\nlet esbuild: esbuild_t | undefined;\nconst utils = {\n    async fetchVersion() {\n        const r = await fetch(JsDelivrAPI).then((r) => r.json());\n        const version = r.tags.latest;\n        localStorage.setItem(\"esbuild-repl\", `${version}:${Date.now()}`);\n        return version;\n    },\n    async version() {\n        const raw = localStorage.getItem(\"esbuild-repl\");\n        if (raw) {\n            const [version, time] = raw.split(\":\", 2);\n            if (Date.now() - +time < 86400 * 1000) {\n                return version;\n            }\n        }\n        return this.fetchVersion();\n    },\n    async esbuild(version: string) {\n        esbuild = (await import(/* @vite-ignore */ urls.browser(version))) as esbuild_t;\n        await esbuild.initialize({ wasmURL: urls.wasm(version) });\n    },\n    dashize(str: string) {\n        return str.replace(/([A-Z])/g, (x) => \"-\" + x.toLowerCase());\n    },\n    camelize(str: string) {\n        return str.replace(/-([a-z])/g, (x) => x.substring(1).toUpperCase());\n    },\n    cfg2cli(config: Record<string, any>) {\n        const options: string[] = [];\n        for (const key in config) {\n            const value = config[key as keyof TransformOptions];\n            if (Array.isArray(value)) {\n                for (const e of value) {\n                    options.push(`--${this.dashize(key)}:${e}`);\n                }\n            } else if (value instanceof Object) {\n                for (const [k, v] of Object.entries(value)) {\n                    options.push(`--${this.dashize(key)}:${k}=${v}`);\n                }\n            } else if (value === true) {\n                options.push(`--${this.dashize(key)}`);\n            } else {\n                options.push(`--${this.dashize(key)}=${value}`);\n            }\n        }\n        return options.join(\" \");\n    },\n    cli2cfg(line: string) {\n        const config: Record<string, any> = {};\n        for (const piece of line.split(/\\s+/)) {\n            if (!piece.startsWith(\"--\")) continue;\n            const a = piece.substring(2);\n            const colon = a.indexOf(\":\");\n            const equal = a.indexOf(\"=\");\n            if (colon === -1 && equal === -1) {\n                config[this.camelize(a)] = true;\n            } else {\n                if (colon !== -1 && colon < equal) {\n                    const key = a.substring(0, colon);\n                    const [k, v] = a.substring(colon + 1).split(\"=\", 2);\n                    config[this.camelize(key)] ||= {};\n                    config[this.camelize(key)][k] = v;\n                } else if (colon !== -1 && equal === -1) {\n                    const [key, value] = a.split(\":\", 2);\n                    config[this.camelize(key)] ||= [];\n                    config[this.camelize(key)].push(value);\n                } else {\n                    const [key, value] = a.split(\"=\", 2);\n                    const val = { true: true, false: false }[value] || value;\n                    config[this.camelize(key)] = val;\n                }\n            }\n        }\n        return config;\n    },\n    loadQuery() {\n        const query = new URLSearchParams(location.search.slice(1));\n        const version = query.get(\"version\");\n        const shareableString = query.get(\"shareable\");\n        let shareable: { code: string; config: Record<string, any> } | null = null;\n        if (shareableString) {\n            try {\n                shareable = JSON.parse(decodeURIComponent(atob(shareableString)));\n            } catch {}\n        }\n        return { version, shareable };\n    },\n    updateQuery(version: string, shareable: object) {\n        const query = new URLSearchParams();\n        query.set(\"version\", version);\n        query.set(\"shareable\", btoa(encodeURIComponent(JSON.stringify(shareable))));\n        const url = location.origin + location.pathname + \"?\" + query.toString();\n        history.pushState({ path: url }, \"\", url);\n    },\n    showError(message: string) {\n        const el = $(\"#error\") as HTMLElement;\n        el.style.display = \"\";\n        el.textContent = message;\n    },\n    hideError() {\n        const el = $(\"#error\") as HTMLElement;\n        el.style.display = \"none\";\n    },\n};\n\n(async function () {\n    const query = utils.loadQuery();\n    console.log(query);\n\n    $(\"#theme\").addEventListener(\"click\", () => {\n        document.body.classList.toggle(\"light\");\n    });\n    const version = query.version || (await utils.version());\n    $(\"#version\").textContent = version;\n    await utils.esbuild(version);\n    leave($(\"#mask\"));\n\n    (window as any).esbuild = esbuild;\n\n    let $config = $(\"#config\") as HTMLInputElement;\n    let $output = $(\"#output\") as HTMLTextAreaElement;\n    let $editor = $(\"#editor\") as HTMLTextAreaElement;\n\n    if (query.shareable?.config != null) {\n        $config.value = utils.cfg2cli(query.shareable?.config);\n    }\n\n    if (query.shareable?.code != null) {\n        $editor.value = query.shareable?.code;\n        $output.value = \"// initializing...\";\n    }\n\n    let config = utils.cli2cfg($config.value);\n    let code = $editor.value;\n\n    $config.addEventListener(\"change\", () => {\n        config = utils.cli2cfg($config.value);\n        $config.value = utils.cfg2cli(config);\n        refresh();\n    });\n\n    $editor.addEventListener(\"keydown\", (e: KeyboardEvent) => {\n        if (e.key === \"Tab\") {\n            e.preventDefault();\n            const textarea = $editor;\n            const code = textarea.value;\n            const before = code.substring(0, textarea.selectionStart);\n            const endPos = textarea.selectionEnd;\n            const after = code.substring(endPos);\n            textarea.value = before + \"    \" + after;\n            textarea.selectionStart = textarea.selectionEnd = endPos + 4;\n        }\n    });\n\n    async function refresh(first = false) {\n        code = $editor.value;\n        try {\n            const t = performance.now();\n            const result = await esbuild?.transform(code, config);\n            const duration = performance.now() - t;\n            if (result) {\n                $output.value = result.code;\n                utils.hideError();\n                if (!first) $(\"#duration\").textContent = duration.toFixed(2) + \"ms\";\n            }\n        } catch (e) {\n            utils.showError(e.message);\n        }\n        try {\n            utils.updateQuery(version, { code, config });\n        } catch {}\n    }\n\n    $editor.addEventListener(\"input\", () => refresh(false));\n\n    refresh(true);\n})().catch((reason) => {\n    console.error(reason);\n    $(\"#mask\").textContent = reason?.message || reason;\n});\n\nif (import.meta.env.PROD)\n    navigator.serviceWorker\n        .register(\"./sw.js\")\n        .then((e) => console.log(\"registered sw.js in scope:\", e.scope))\n        .catch((e) => console.log(\"failed to register sw.js:\", e));\n"],"names":["relList","document","createElement","supports","link","querySelectorAll","MutationObserver","mutations","mutation","type","node","addedNodes","tagName","rel","observe","childList","subtree","ep","fetchOpts","script","integrity","referrerpolicy","referrerPolicy","crossorigin","credentials","getFetchOpts","href","p","seen","$","sel","querySelector","urlPrefix","urls","version","esbuild","utils","fetch","then","r2","json","tags","latest","setItem","Date","now","raw","localStorage","getItem","time","split","this","fetchVersion","baseModule","deps","length","Promise","all","map","dep","isCss","endsWith","cssSelector","as","crossOrigin","head","appendChild","res","rej","addEventListener","initialize","wasmURL","dashize","str","replace","x","toLowerCase","camelize","substring","toUpperCase","cfg2cli","config","options","key","value","Array","isArray","e","push","Object","k","v","entries","join","cli2cfg","line","piece","startsWith","a","colon","indexOf","equal","val","true","false","loadQuery","query","URLSearchParams","location","search","slice","get","shareableString","shareable","JSON","parse","decodeURIComponent","atob","updateQuery","set","btoa","encodeURIComponent","stringify","url","origin","pathname","toString","pushState","path","showError","message","el","style","display","textContent","hideError","log","body","classList","toggle","ms","add","remove","$config","$output","$editor","code","first","t","performance","result","transform","duration","toFixed","preventDefault","textarea","code2","before","selectionStart","endPos","selectionEnd","after","refresh","catch","reason","error","serviceWorker","register","console","scope"],"mappings":"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"}