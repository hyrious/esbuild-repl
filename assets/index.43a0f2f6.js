let e;const t={};var n=/^--([-a-z]+)(?::([^=]+))?(?:=(.+))?$/,s={true:!0,false:!1};const r=e=>document.querySelector(e);const o="https://cdn.jsdelivr.net/npm/esbuild-wasm",i=e=>`${o}@${e}/esm/browser.js`,a=e=>`${o}@${e}/esbuild.wasm`;let l;const c={async fetchVersion(){const e=(await fetch("https://data.jsdelivr.com/v1/package/npm/esbuild-wasm").then((e=>e.json()))).tags.latest;return localStorage.setItem("esbuild-repl",`${e}:${Date.now()}`),e},async version(){const e=localStorage.getItem("esbuild-repl");if(e){const[t,n]=e.split(":",2);if(Date.now()-+n<6048e5)return t}return this.fetchVersion()},async esbuild(n){l=await function(n,s){if(!s||0===s.length)return n();if(void 0===e){const t=document.createElement("link").relList;e=t&&t.supports&&t.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(s.map((n=>{if((n=`${n}`)in t)return;t[n]=!0;const s=n.endsWith(".css"),r=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${r}`))return;const o=document.createElement("link");return o.rel=s?"stylesheet":e,s||(o.as="script",o.crossOrigin=""),o.href=n,document.head.appendChild(o),s?new Promise(((e,t)=>{o.addEventListener("load",e),o.addEventListener("error",t)})):void 0}))).then((()=>n()))}((()=>import(i(n))),[]),await l.initialize({wasmURL:a(n)})},cfg2cli:e=>function(e){let t=[];Array.isArray(e.entryPoints)?t.push(...e.entryPoints):e.entryPoints&&t.push(...Object.entries(e.entryPoints).map((([e,t])=>`${e}=${t}`))),delete e.entryPoints,delete e.plugins;for(let[n,s]of Object.entries(e)){let e=n.replace(/([A-Z])/g,(e=>"-"+e.toLowerCase()));Array.isArray(s)?["resolveExtensions","mainFields","conditions","target"].includes(n)?t.push(`--${e}=${s.join(",")}`):t.push(...s.map((t=>`--${e}:${t}`))):"object"==typeof s&&null!==s?t.push(...Object.entries(s).map((([t,n])=>`--${e}:${t}=${JSON.stringify(n)}`))):t.push(`--${e}=${s}`)}return t}(e).join(" "),cli2cfg:e=>function(e){let t={};for(let r of e){let e=n.exec(r);if(!e)throw new Error(`unknown arg: ${r}`);{let[,n,r,o]=e,i=n.split("-").reduce(((e,t)=>{return e+((n=t).charAt(0).toUpperCase()+n.slice(1));var n}));if(r&&o)(t[i]||(t[i]={}))[r]=o;else if(r)(t[i]||(t[i]=[])).push(r);else if(o){let e=s[o];void 0!==e?t[i]=e:o.includes(",")?t[i]=o.split(","):t[i]=o}else t[i]=!0}}return t}(e.split(/\s+/)),loadQuery(){const e=new URLSearchParams(location.search.slice(1)),t=e.get("version"),n=e.get("shareable");let s=null;if(n)try{s=JSON.parse(decodeURIComponent(atob(n)))}catch{}return{version:t,shareable:s}},updateQuery(e,t){const n=new URLSearchParams;n.set("version",e),n.set("shareable",btoa(encodeURIComponent(JSON.stringify(t))));const s=location.origin+location.pathname+"?"+n.toString();history.pushState({path:s},"",s)},showError(e){const t=r("#error");t.style.display="",t.textContent=e},hideError(){r("#error").style.display="none"}};(async function(){var e,t,n,s;const o=c.loadQuery();console.log(o),r("#theme").addEventListener("click",(()=>{document.body.classList.toggle("light")}));const i=o.version||await c.version();r("#version").textContent=i,await c.esbuild(i),function(e,t=200){e.classList.add("leave","leave-active"),requestAnimationFrame((()=>{e.classList.remove("leave"),e.classList.add("leave-to")})),setTimeout((()=>e.remove()),t)}(r("#mask")),window.esbuild=l;let a=r("#config"),u=r("#output"),d=r("#editor");null!=(null==(e=o.shareable)?void 0:e.config)&&(a.value=c.cfg2cli(null==(t=o.shareable)?void 0:t.config)),null!=(null==(n=o.shareable)?void 0:n.code)&&(d.value=null==(s=o.shareable)?void 0:s.code,u.value="// initializing...");let p=c.cli2cfg(a.value),h=d.value;async function v(e=!1){h=d.value;try{const t=performance.now(),n=await(null==l?void 0:l.transform(h,p)),s=performance.now()-t;n&&(u.value=n.code,c.hideError(),e||(r("#duration").textContent=s.toFixed(2)+"ms"))}catch(t){c.showError(t.message)}try{c.updateQuery(i,{code:h,config:p})}catch{}}a.addEventListener("change",(()=>{p=c.cli2cfg(a.value),a.value=c.cfg2cli(p),v()})),d.addEventListener("keydown",(e=>{if("Tab"===e.key){e.preventDefault();const t=d,n=t.value,s=n.substring(0,t.selectionStart),r=t.selectionEnd,o=n.substring(r);t.value=s+"    "+o,t.selectionStart=t.selectionEnd=r+4}})),d.addEventListener("input",(()=>v(!1))),v(!0)})().catch((e=>{console.error(e),r("#mask").textContent=(null==e?void 0:e.message)||e})),navigator.serviceWorker.register("./sw.js").then((e=>console.log("registered sw.js in scope:",e.scope))).catch((e=>console.log("failed to register sw.js:",e)));
//# sourceMappingURL=index.43a0f2f6.js.map
