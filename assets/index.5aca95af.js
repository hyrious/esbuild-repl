let e;const t={},s=e=>document.querySelector(e);const n="https://cdn.jsdelivr.net/npm/esbuild-wasm",o=e=>`${n}@${e}/esm/browser.js`,i=e=>`${n}@${e}/esbuild.wasm`;let r;const a={async fetchVersion(){const e=(await fetch("https://data.jsdelivr.com/v1/package/npm/esbuild-wasm").then((e=>e.json()))).tags.latest;return localStorage.setItem("esbuild-repl",`${e}:${Date.now()}`),e},async version(){const e=localStorage.getItem("esbuild-repl");if(e){const[t,s]=e.split(":",2);if(Date.now()-+s<6048e5)return t}return this.fetchVersion()},async esbuild(s){r=await function(s,n){if(!n||0===n.length)return s();if(void 0===e){const t=document.createElement("link").relList;e=t&&t.supports&&t.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(n.map((s=>{if((s=`${s}`)in t)return;t[s]=!0;const n=s.endsWith(".css"),o=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${o}`))return;const i=document.createElement("link");return i.rel=n?"stylesheet":e,n||(i.as="script",i.crossOrigin=""),i.href=s,document.head.appendChild(i),n?new Promise(((e,t)=>{i.addEventListener("load",e),i.addEventListener("error",t)})):void 0}))).then((()=>s()))}((()=>import(o(s))),[]),await r.initialize({wasmURL:i(s)})},dashize:e=>e.replace(/([A-Z])/g,(e=>"-"+e.toLowerCase())),camelize:e=>e.replace(/-([a-z])/g,(e=>e.substring(1).toUpperCase())),cfg2cli(e){const t=[];for(const s in e){const n=e[s];if(Array.isArray(n))for(const e of n)t.push(`--${this.dashize(s)}:${e}`);else if(n instanceof Object)for(const[e,o]of Object.entries(n))t.push(`--${this.dashize(s)}:${e}=${o}`);else!0===n?t.push(`--${this.dashize(s)}`):t.push(`--${this.dashize(s)}=${n}`)}return t.join(" ")},cli2cfg(e){var t,s;const n={};for(const o of e.split(/\s+/)){if(!o.startsWith("--"))continue;const e=o.substring(2),i=e.indexOf(":"),r=e.indexOf("=");if(-1===i&&-1===r)n[this.camelize(e)]=!0;else if(-1!==i&&i<r){const s=e.substring(0,i),[o,r]=e.substring(i+1).split("=",2);n[t=this.camelize(s)]||(n[t]={}),n[this.camelize(s)][o]=r}else if(-1!==i&&-1===r){const[t,o]=e.split(":",2);n[s=this.camelize(t)]||(n[s]=[]),n[this.camelize(t)].push(o)}else{const[t,s]=e.split("=",2),o={true:!0,false:!1}[s]||s;n[this.camelize(t)]=o}}return n},loadQuery(){const e=new URLSearchParams(location.search.slice(1)),t=e.get("version"),s=e.get("shareable");let n=null;if(s)try{n=JSON.parse(decodeURIComponent(atob(s)))}catch{}return{version:t,shareable:n}},updateQuery(e,t){const s=new URLSearchParams;s.set("version",e),s.set("shareable",btoa(encodeURIComponent(JSON.stringify(t))));const n=location.origin+location.pathname+"?"+s.toString();history.pushState({path:n},"",n)},showError(e){const t=s("#error");t.style.display="",t.textContent=e},hideError(){s("#error").style.display="none"}};(async function(){var e,t,n,o;const i=a.loadQuery();console.log(i),s("#theme").addEventListener("click",(()=>{document.body.classList.toggle("light")}));const l=i.version||await a.version();s("#version").textContent=l,await a.esbuild(l),function(e,t=200){e.classList.add("leave","leave-active"),requestAnimationFrame((()=>{e.classList.remove("leave"),e.classList.add("leave-to")})),setTimeout((()=>e.remove()),t)}(s("#mask")),window.esbuild=r,null!=(null==(e=i.shareable)?void 0:e.config)&&(s("#config").value=a.cfg2cli(null==(t=i.shareable)?void 0:t.config)),null!=(null==(n=i.shareable)?void 0:n.code)&&(s("#editor").value=null==(o=i.shareable)?void 0:o.code,s("#output").value="");let c=a.cli2cfg(s("#config").value),d=s("#editor").value;async function u(e=!1){d=s("#editor").value;try{const t=performance.now(),n=await(null==r?void 0:r.transform(d,c)),o=performance.now()-t;n&&(s("#output").value=n.code,a.hideError(),e||(s("#duration").textContent=o.toFixed(2)+"ms"))}catch(t){a.showError(t.message)}try{a.updateQuery(l,{code:d,config:c})}catch{}}s("#config").addEventListener("change",(e=>{const t=e.target;c=a.cli2cfg(t.value),t.value=a.cfg2cli(c),u()})),s("#editor").addEventListener("keydown",(e=>{if("Tab"===e.key){e.preventDefault();const t=e.target,s=t.value,n=s.substring(0,t.selectionStart),o=t.selectionEnd,i=s.substring(o);t.value=n+"    "+i,t.selectionStart=t.selectionEnd=o+4}})),s("#editor").addEventListener("input",(()=>u(!1))),u(!0)})().catch((e=>{console.error(e),s("#mask").textContent=(null==e?void 0:e.message)||e})),navigator.serviceWorker.register("./sw.js").then((e=>console.log("registered sw.js in scope:",e.scope))).catch((e=>console.log("failed to register sw.js:",e)));
//# sourceMappingURL=index.5aca95af.js.map
