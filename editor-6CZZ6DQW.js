import"./chunk-ON5OQYWL.js";function H(e,t){var n=t===void 0?{}:t,r=n.viewportMarginBottom,i=r===void 0?100:r,o=null,s=!1,l,c,u;function a(m){if(l!==m.clientX||c!==m.clientY){var f=e.style.height;u&&u!==f&&(s=!0,e.style.maxHeight="",e.removeEventListener("mousemove",a)),u=f}l=m.clientX,c=m.clientY}var d=e.ownerDocument,v=d.documentElement;function y(){for(var m=0,f=e;f!==d.body&&f!==null;)m+=f.offsetTop||0,f=f.offsetParent;var p=m-d.defaultView.pageYOffset,S=v.clientHeight-(p+e.offsetHeight);return{top:p,bottom:S}}function g(){if(!s&&e.value!==o&&!(e.offsetWidth<=0&&e.offsetHeight<=0)){var m=y(),f=m.top,p=m.bottom;if(!(f<0||p<0)){var S=getComputedStyle(e),F=Number(S.borderTopWidth.replace(/px/,"")),O=Number(S.borderBottomWidth.replace(/px/,"")),le=S.boxSizing==="border-box",ae=le?F+O:0,ce=Number(S.height.replace(/px/,""))+p,ue=p<i?p:i;e.style.maxHeight=ce-ue+"px";var w=e.parentElement;if(w instanceof HTMLElement){var de=w.style.height;w.style.height=getComputedStyle(w).height,e.style.height="auto",e.style.height=e.scrollHeight+ae+"px",w.style.height=de,u=e.style.height}o=e.value}}}function I(){s=!1,e.style.height="",e.style.maxHeight=""}e.addEventListener("mousemove",a),e.addEventListener("input",g),e.addEventListener("change",g),e.addEventListener("paste",g);var E=e.form;return E&&E.addEventListener("reset",I),e.value&&g(),{unsubscribe:function(){e.removeEventListener("mousemove",a),e.removeEventListener("input",g),e.removeEventListener("change",g),e.removeEventListener("paste",g),E&&E.removeEventListener("reset",I)}}}function h(){if(!(this instanceof h))return new h;this.size=0,this.uid=0,this.selectors=[],this.selectorObjects={},this.indexes=Object.create(this.indexes),this.activeIndexes=[]}var L=window.document.documentElement,fe=L.matches||L.webkitMatchesSelector||L.mozMatchesSelector||L.oMatchesSelector||L.msMatchesSelector;h.prototype.matchesSelector=function(e,t){return fe.call(e,t)};h.prototype.querySelectorAll=function(e,t){return t.querySelectorAll(e)};h.prototype.indexes=[];var he=/^#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;h.prototype.indexes.push({name:"ID",selector:function(t){var n;if(n=t.match(he))return n[0].slice(1)},element:function(t){if(t.id)return[t.id]}});var ve=/^\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;h.prototype.indexes.push({name:"CLASS",selector:function(t){var n;if(n=t.match(ve))return n[0].slice(1)},element:function(t){var n=t.className;if(n){if(typeof n=="string")return n.split(/\s/);if(typeof n=="object"&&"baseVal"in n)return n.baseVal.split(/\s/)}}});var me=/^((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;h.prototype.indexes.push({name:"TAG",selector:function(t){var n;if(n=t.match(me))return n[0].toUpperCase()},element:function(t){return[t.nodeName.toUpperCase()]}});h.prototype.indexes.default={name:"UNIVERSAL",selector:function(){return!0},element:function(){return[!0]}};var B;typeof window.Map=="function"?B=window.Map:B=function(){function e(){this.map={}}return e.prototype.get=function(t){return this.map[t+" "]},e.prototype.set=function(t,n){this.map[t+" "]=n},e}();var P=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g;function z(e,t){e=e.slice(0).concat(e.default);var n=e.length,r,i,o,s,l=t,c,u,a=[];do if(P.exec(""),(o=P.exec(l))&&(l=o[3],o[2]||!l)){for(r=0;r<n;r++)if(u=e[r],c=u.selector(o[1])){for(i=a.length,s=!1;i--;)if(a[i].index===u&&a[i].key===c){s=!0;break}s||a.push({index:u,key:c});break}}while(o);return a}function pe(e,t){var n,r,i;for(n=0,r=e.length;n<r;n++)if(i=e[n],t.isPrototypeOf(i))return i}h.prototype.logDefaultIndexUsed=function(){};h.prototype.add=function(e,t){var n,r,i,o,s,l,c,u,a=this.activeIndexes,d=this.selectors,v=this.selectorObjects;if(typeof e=="string"){for(n={id:this.uid++,selector:e,data:t},v[n.id]=n,c=z(this.indexes,e),r=0;r<c.length;r++)u=c[r],o=u.key,i=u.index,s=pe(a,i),s||(s=Object.create(i),s.map=new B,a.push(s)),i===this.indexes.default&&this.logDefaultIndexUsed(n),l=s.map.get(o),l||(l=[],s.map.set(o,l)),l.push(n);this.size++,d.push(e)}};h.prototype.remove=function(e,t){if(typeof e=="string"){var n,r,i,o,s,l,c,u,a=this.activeIndexes,d=this.selectors=[],v=this.selectorObjects,y={},g=arguments.length===1;for(n=z(this.indexes,e),i=0;i<n.length;i++)for(r=n[i],o=a.length;o--;)if(l=a[o],r.index.isPrototypeOf(l)){if(c=l.map.get(r.key),c)for(s=c.length;s--;)u=c[s],u.selector===e&&(g||u.data===t)&&(c.splice(s,1),y[u.id]=!0);break}for(i in y)delete v[i],this.size--;for(i in v)d.push(v[i].selector)}};function Y(e,t){return e.id-t.id}h.prototype.queryAll=function(e){if(!this.selectors.length)return[];var t={},n=[],r=this.querySelectorAll(this.selectors.join(", "),e),i,o,s,l,c,u,a,d;for(i=0,s=r.length;i<s;i++)for(c=r[i],u=this.matches(c),o=0,l=u.length;o<l;o++)d=u[o],t[d.id]?a=t[d.id]:(a={id:d.id,selector:d.selector,data:d.data,elements:[]},t[d.id]=a,n.push(a)),a.elements.push(c);return n.sort(Y)};h.prototype.matches=function(e){if(!e)return[];var t,n,r,i,o,s,l,c,u,a,d,v=this.activeIndexes,y={},g=[];for(t=0,i=v.length;t<i;t++)if(l=v[t],c=l.element(e),c){for(n=0,o=c.length;n<o;n++)if(u=l.map.get(c[n]))for(r=0,s=u.length;r<s;r++)a=u[r],d=a.id,!y[d]&&this.matchesSelector(e,a.selector)&&(y[d]=!0,g.push(a))}return g.sort(Y)};var R=null,q=null,V=[];function Q(e,t){var n=[];function r(){var o=n;n=[],t(o)}function i(){for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];n.push(s),n.length===1&&K(e,r)}return i}function K(e,t){q||(q=new MutationObserver(ge)),R||(R=e.createElement("div"),q.observe(R,{attributes:!0})),V.push(t),R.setAttribute("data-twiddle",""+Date.now())}function ge(){var e=V;V=[];for(var t=0;t<e.length;t++)try{e[t]()}catch(n){setTimeout(function(){throw n},0)}}var X=new WeakMap,M=new WeakMap,k=new WeakMap,b=new WeakMap;function N(e,t){for(var n=0;n<t.length;n++){var r=t[n],i=r[0],o=r[1],s=r[2];i===A?(ye(s,o),Ee(s,o)):i===J?$(s,o):i===C&&Se(e.observers,o)}}function ye(e,t){if(t instanceof e.elementConstructor){var n=X.get(t);if(n||(n=[],X.set(t,n)),n.indexOf(e.id)===-1){var r=void 0;if(e.initialize&&(r=e.initialize.call(void 0,t)),r){var i=M.get(t);i||(i={},M.set(t,i)),i[""+e.id]=r}n.push(e.id)}}}function Ee(e,t){if(t instanceof e.elementConstructor){var n=b.get(t);if(n||(n=[],b.set(t,n)),n.indexOf(e.id)===-1){e.elements.push(t);var r=M.get(t),i=r?r[""+e.id]:null;if(i&&i.add&&i.add.call(void 0,t),e.subscribe){var o=e.subscribe.call(void 0,t);if(o){var s=k.get(t);s||(s={},k.set(t,s)),s[""+e.id]=o}}e.add&&e.add.call(void 0,t),n.push(e.id)}}}function $(e,t){if(t instanceof e.elementConstructor){var n=b.get(t);if(n){var r=e.elements.indexOf(t);if(r!==-1&&e.elements.splice(r,1),r=n.indexOf(e.id),r!==-1){var i=M.get(t),o=i?i[""+e.id]:null;if(o&&o.remove&&o.remove.call(void 0,t),e.subscribe){var s=k.get(t),l=s?s[""+e.id]:null;l&&l.unsubscribe&&l.unsubscribe()}e.remove&&e.remove.call(void 0,t),n.splice(r,1)}n.length===0&&b.delete(t)}}}function Se(e,t){var n=b.get(t);if(n){for(var r=n.slice(0),i=0;i<r.length;i++){var o=e[r[i]];if(o){var s=o.elements.indexOf(t);s!==-1&&o.elements.splice(s,1);var l=M.get(t),c=l?l[""+o.id]:null;c&&c.remove&&c.remove.call(void 0,t);var u=k.get(t),a=u?u[""+o.id]:null;a&&a.unsubscribe&&a.unsubscribe(),o.remove&&o.remove.call(void 0,t)}}b.delete(t)}}var U=null;function be(e){if(U===null){var t=e.createElement("div"),n=e.createElement("div"),r=e.createElement("div");t.appendChild(n),n.appendChild(r),t.innerHTML="",U=r.parentNode!==n}return U}function G(e){return"matches"in e||"webkitMatchesSelector"in e||"mozMatchesSelector"in e||"oMatchesSelector"in e||"msMatchesSelector"in e}var A=1,J=2,C=3;function we(e,t,n){for(var r=0;r<n.length;r++){var i=n[r];i.type==="childList"?(Z(e,t,i.addedNodes),Le(e,t,i.removedNodes)):i.type==="attributes"&&D(e,t,i.target)}be(e.ownerDocument)&&xe(e,t)}function Z(e,t,n){for(var r=0;r<n.length;r++){var i=n[r];if(G(i))for(var o=e.selectorSet.matches(i),s=0;s<o.length;s++){var l=o[s].data;t.push([A,i,l])}if("querySelectorAll"in i)for(var c=e.selectorSet.queryAll(i),u=0;u<c.length;u++)for(var a=c[u],d=a.data,v=a.elements,y=0;y<v.length;y++)t.push([A,v[y],d])}}function Le(e,t,n){for(var r=0;r<n.length;r++){var i=n[r];if("querySelectorAll"in i){t.push([C,i]);for(var o=i.querySelectorAll("*"),s=0;s<o.length;s++)t.push([C,o[s]])}}}function D(e,t,n){if(G(n))for(var r=e.selectorSet.matches(n),i=0;i<r.length;i++){var o=r[i].data;t.push([A,n,o])}if("querySelectorAll"in n){var s=b.get(n);if(s)for(var l=0;l<s.length;l++){var c=e.observers[s[l]];c&&(e.selectorSet.matchesSelector(n,c.selector)||t.push([J,n,c]))}}}function Me(e,t,n){if("querySelectorAll"in n){D(e,t,n);for(var r=n.querySelectorAll("*"),i=0;i<r.length;i++)D(e,t,r[i])}}function Te(e,t,n){for(var r=0;r<n.length;r++)for(var i=n[r],o=i.form?i.form.elements:e.rootNode.querySelectorAll("input"),s=0;s<o.length;s++)D(e,t,o[s])}function xe(e,t){for(var n=0;n<e.observers.length;n++){var r=e.observers[n];if(r)for(var i=r.elements,o=0;o<i.length;o++){var s=i[o];s.parentNode||t.push([C,s])}}}function Ie(e,t){var n=e.readyState;n==="interactive"||n==="complete"?K(e,t):e.addEventListener("DOMContentLoaded",K(e,t))}var Oe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Re=0;function T(e){this.rootNode=e.nodeType===9?e.documentElement:e,this.ownerDocument=e.nodeType===9?e:e.ownerDocument,this.observers=[],this.selectorSet=new h,this.mutationObserver=new MutationObserver(Ce.bind(this,this)),this._scheduleAddRootNodes=Q(this.ownerDocument,Ae.bind(this,this)),this._handleThrottledChangedTargets=Q(this.ownerDocument,Ne.bind(this,this)),this.rootNode.addEventListener("change",De.bind(this,this),!1),Ie(this.ownerDocument,ke.bind(this,this))}T.prototype.disconnect=function(){this.mutationObserver.disconnect()};T.prototype.observe=function(e,t){var n=void 0;typeof t=="function"?n={selector:e,initialize:t}:(typeof t>"u"?"undefined":Oe(t))==="object"?(n=t,n.selector=e):n=e;var r=this,i={id:Re++,selector:n.selector,initialize:n.initialize,add:n.add,remove:n.remove,subscribe:n.subscribe,elements:[],elementConstructor:n.hasOwnProperty("constructor")?n.constructor:this.ownerDocument.defaultView.Element,abort:function(){r._abortObserving(i)}};return this.selectorSet.add(i.selector,i),this.observers[i.id]=i,this._scheduleAddRootNodes(),i};T.prototype._abortObserving=function(e){for(var t=e.elements,n=0;n<t.length;n++)$(e,t[n]);this.selectorSet.remove(e.selector,e),delete this.observers[e.id]};T.prototype.triggerObservers=function(e){var t=[];Me(this,t,e),N(this,t)};function ke(e){e.mutationObserver.observe(e.rootNode,{childList:!0,attributes:!0,subtree:!0}),e._scheduleAddRootNodes()}function Ae(e){var t=[];Z(e,t,[e.rootNode]),N(e,t)}function Ce(e,t){var n=[];we(e,n,t),N(e,n)}function De(e,t){e._handleThrottledChangedTargets(t.target)}function Ne(e,t){var n=[];Te(e,n,t),N(e,n)}var j=void 0;function Fe(){return j||(j=new T(window.document)),j}function ee(){var e;return(e=Fe()).observe.apply(e,arguments)}function He(e,t,n){return e.dispatchEvent(new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n}))}var W=/^(\s*)/;function Be(e,t,n){let r=t[0];if(!r||!e)return;let i=t[1]||r,o=e.slice(0,r).split(`
`),s=o[o.length-1],l=s?.match(W);if(!l)return;let c=l[1]||"",u=`
${c}`;if(n==="here")return{text:e.slice(0,r)+u+e.slice(i),selection:[r+u.length,i+u.length]};if(n==="begin"){let a=r-s.length;return{text:e.slice(0,a)+`${c}
`+e.slice(a),selection:[a+c.length,a+c.length]}}else{let a=e.indexOf(`
`,i),d=a<0?e.length:a;return{text:e.slice(0,d)+u+e.slice(d),selection:[d+u.length,d+u.length]}}}function qe(e,t,n){let r=t[0]||0,i=t[1]||r;if(t[0]===null)return;if(r===i)if(n){let E=e.slice(0,i).split(`
`),m=E[E.length-1],f=m?.match(W);if(!f)return;let p=f[0],S=p.length,F=m.slice(p.length);p=p.slice(0,-2);let O=S-p.length;return E[E.length-1]=p+F,{text:E.join(`
`)+e.slice(i),selection:[i-O,i-O]}}else return{text:e.slice(0,r)+"  "+e.slice(i),selection:[i+2,i+2]};let o=e.slice(0,r).lastIndexOf(`
`)+1,s=e.indexOf(`
`,i-1),l=s>0?s:e.length-1,c=e.slice(o,l).split(`
`),u=!1,a=0,d=0,v=[];for(let E of c){let m=E.match(W);if(m){let f=m[0],p=E.slice(f.length);if(n){let S=f.length;f=f.slice(0,-2),a=u?a:f.length-S,u=!0,d+=f.length-S}else f+="  ",a=2,d+=2;v.push(f+p)}}let y=v.join(`
`),g=e.slice(0,o)+y+e.slice(l),I=[Math.max(o,r+a),i+d];return{text:g,selection:I}}function Ue(e){let n=e.target;n.selectionDirection==="backward"?n.selectionEnd=n.selectionStart:n.selectionStart=n.selectionEnd}var x=!1;function te(){x=!0}function ne(){x=!1}function _(e,t,n){e.value=t.text,e.selectionStart=t.selection[0],e.selectionEnd=t.selection[1],n.preventDefault(),He(e,"input")}function ie(e){if(x)return;let t=e;if(t.key==="Enter"){let n=t.target,r,i=t.metaKey||t.ctrlKey,o=t.shiftKey;if(o&&!i?r="here":i&&!o?r="end":i&&o&&(r="begin"),!r)return;let s=Be(n.value,[n.selectionStart,n.selectionEnd],r);if(s===void 0)return;_(n,s,t)}}var se=["`","'",'"',"[","(","{","*","_","~","\u201C","\u2018"],je=["`","'",'"',"]",")","}","*","_","~","\u201D","\u2019"];function re(e){if(x)return;let t=e;if(!se.includes(t.key))return;let n=t.target,[r,i]=[n.selectionStart,n.selectionEnd];if(r===i)return;let o=Ve(n.value,[r,i],t.key);o!==void 0&&_(n,o,t)}function Ve(e,[t,n],r){if(t==null||n==null||t===n)return;let i=je[se.indexOf(r)],o=e.slice(t,n);return{text:e.slice(0,t)+r+o+i+e.slice(n),selection:[t+r.length,n+r.length]}}function oe(e){if(x)return;let t=e;if(t.key==="Escape"){Ue(e);return}if(t.key!=="Tab")return;let n=t.target,r=qe(n.value,[n.selectionStart,n.selectionEnd],t.shiftKey);r!==void 0&&_(n,r,t)}function Ke(e){e.addEventListener("keydown",oe),e.addEventListener("keydown",ie),e.addEventListener("keydown",re),e.addEventListener("compositionstart",te),e.addEventListener("compositionend",ne);let{unsubscribe:t}=H(e);return{unsubscribe:()=>{e.removeEventListener("keydown",oe),e.removeEventListener("keydown",ie),e.removeEventListener("keydown",re),e.removeEventListener("compositionstart",te),e.removeEventListener("compositionend",ne),t()}}}var Xe=ee("textarea.editor",{subscribe:Ke});export{Xe as abortController,He as fire,Ke as subscribe};
//# sourceMappingURL=editor-6CZZ6DQW.js.map
